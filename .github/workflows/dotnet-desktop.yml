name: "Dotnet build"

on:
    push:
        tags:
        - "desktop/v*"

jobs:

  build:
    runs-on: windows-latest
    steps:
    
    - name: Get current date
      id: date
      run: echo "::set-output name=date::$(date +'%Y-%m-%d')"
      
    - name: Checkout
      uses: actions/checkout@v2
      with:
        fetch-depth: 0

    # Install the .NET Core workload
    - name: Install .NET Core
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: 5.0.x

    # Restore the application to populate the obj folder with RuntimeIdentifiers
    - name: Restore the application
      run: dotnet restore

    # Build Debug
    #- name: Build Debug
     # run: dotnet build LibrusPlan\LibrusPlan.csproj --configuration Debug
        
    # Build Debug
    - name: Build Release
      run: dotnet build LibrusPlan\LibrusPlan.csproj --configuration Release

    # Debug
    #- name: Upload Debug
    #  uses: actions/upload-artifact@v2
     # with:
      #  name: ${{ steps.date.outputs.date }} Debug
      #  path: LibrusPlan\bin\Debug\net5.0-windows
        
    # Release
    - name: Upload Release
      uses: actions/upload-artifact@v2
      with:
        name: ${{ steps.date.outputs.date }} Release
        path: LibrusPlan\bin\Release\net5.0-windows
